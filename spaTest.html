<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title></title>
	</head>

	<body>
		</br></br></br></br>
		<center>
			<font color="#4682B4" size="60px">我的測試頁</font>
			</br></br></br></br></br>
			<a href="tel:0988777555">0988777555</a>
			</br></br></br></br></br>
			<a href="tel:02-23442999">02-23442999</a>
			</br></br></br></br></br>
			<a href="mailto:aaaa@cht.com.tw">aaaa@cht.com.tw</a>
			</br></br></br></br></br>
			<a href="http://192.168.119.57:8080/myTest.html">localhost web page</a>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="teams()">teams</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getUserInfo()">getUserInfo</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getAppList()">getAppList</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="indexDB()">testIndexedDB</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="readDB()">readDB</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getDB()">testDB</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getWebView()">getWebView</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getRest()">getRest</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getAuth()">getAuth</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getAuthNew()">getAuthNew</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getDefault()">getDefault</button>
            </br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="reAuth()">reAuth</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getAppConfig()">getAppConfig</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="dialPhoneNumber()">dial</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="dialPhoneNumber2()">dial2</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="composeEmail()">composeEmail</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getGPS()">getGPS</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="nmoss()">nmoss</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getTelInfo()">getTelInfo</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getBarCode()">getBarCode</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getQRCode()">getQRCode</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getQRCodeCustom()">getQRCodeCustom</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="closeCamera()">closeCamera</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getCamera()">getCamera</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="pickFileAll()">pickFileAll</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="pickFileAlbum()">pickFileAlbum</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="pickFileDoc()">pickFileDoc</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="speech()">speech</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="cancelSpeech()">cancelSpeech</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="openUrl()">openUrl</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getRestNew()">getRestNew</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="goPortal()">goPortal</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="goApp()">goApp</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="goAppArg()">goAppArg</button>
            </br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="getPushNoti()">getPushNoti</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="setNotiViewed()">setNotiViewed</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="useBiometrics()">useBiometrics</button>
			</br></br></br></br></br>
			<button type="button" style="font-size:120px" onClick="appRefresh()">appRefresh</button>
			</br></br></br></br></br>
			<img id=img src="">
			<img id=img1 src="">
			<img id=img2 src="">
			<img id=img3 src="">
			<img id=img4 src="">
			<img id=img5 src="">
            <input type="file" style="font-size:50px" accept="image/*">
		</center>
	</body>

	<script>
	var db;
		function indexDB() {
			// In the following line, you should include the prefixes of implementations you want to test.
window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
// DON'T use "var indexedDB = ..." if you're not in a function.
// Moreover, you may need references to some window.IDB* objects:
window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction;
window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange;
// (Mozilla has never prefixed these objects, so we don't need window.mozIDB*)
			if (!window.indexedDB) {
    window.alert("Your browser doesn't support a stable version of IndexedDB. Such and such feature will not be available.");
} else {
const customerData = [
  { ssn: "444-44-4444", name: "Bill", age: 35, email: "bill@company.com" },
  { ssn: "555-55-5555", name: "Donna", age: 32, email: "donna@home.org" }
];
const dbName = "the_name";

var request = window.indexedDB.open(dbName, 2);

request.onerror = function(event) {
  // Handle errors.
};
request.onupgradeneeded = function(event) {
  db = event.target.result;

  // Create an objectStore to hold information about our customers. We're
  // going to use "ssn" as our key path because it's guaranteed to be
  // unique.
  var objectStore = db.createObjectStore("customers", { keyPath: "ssn" });

  // Create an index to search customers by name. We may have duplicates
  // so we can't use a unique index.
  objectStore.createIndex("name", "name", { unique: false });

  // Create an index to search customers by email. We want to ensure that
  // no two customers have the same email, so use a unique index.
  objectStore.createIndex("email", "email", { unique: true });

  // Store values in the newly created objectStore.
  for (var i in customerData) {
    objectStore.add(customerData[i]);
  }
};
}
		}
		function readDB() {
			var transaction = db.transaction(["customers"]);
var objectStore = transaction.objectStore("customers");
var request = objectStore.get("444-44-4444");
request.onerror = function(event) {
  // Handle errors!
};
request.onsuccess = function(event) {
  // Do something with the request.result!
  alert("Name for SSN 444-44-4444 is " + request.result.name);
};
		}

		function saveToStorage() {
            //window.localStorage.setItem("UserData", inputArea.value);
            //localStorage.setItem("UserData", inputArea.value);
            //localStorage["UserData"] = inputArea.value;
            localStorage.UserData = "aaaa";
            sessionStorage.UserData = "bbbb";
        }

        function loadFromLocalStorage() {
            alert(localStorage["UserData"]);
        }

        function loadFromSessionStorage() {
            alert(sessionStorage["UserData"]);
        }
        function useBiometrics() {
        	var myObj = { "cmd": "useBiometrics"};
            callAppCmd(JSON.stringify(myObj));
        }
        function nmoss() {
        	var cmd=`{"cmd": "rest","value":{
			"id": "rest1", // 用 id 區分 request 是何者發送的，之後 response 時會以同樣的 id 去區分
			"restConfig": {
			  "name": "NMOSS", // api 名稱
			  "body": "0000,830421,mario", // 參數
			  "headers": { "Content-Type": "application/json" }, // 標頭
			  "method": "POST"

			}
		  }}`;
        	callAppCmd(cmd);
        }
		function getPushNoti(){
			var myObj = { "cmd": "getPushNoti"};
			callAppCmd(JSON.stringify(myObj));
		}
		function appRefresh(){
            var myObj = { "cmd": "appRefresh"};
            callAppCmd(JSON.stringify(myObj));
        }
		function getDB(){
			var myObj = { "cmd": "execSQL", "value": {"sql":"drop table test"}};
			callAppCmd(JSON.stringify(myObj));
			myObj = { "cmd": "execSQL", "value": {"sql":"create table if not exists test(id INTEGER PRIMARY KEY AUTOINCREMENT,key TEXT, val TEXT, ii INTEGER,ff FLOAT)"}};
			//callAppCmd(JSON.stringify(myObj));
			myObj = { "cmd": "execSQL", "value": {"sql":"insert into test(id, key,val,ii,ff) values (?,?,?,?,?)","args":[2,"test",null,2,1.111]}};
			callAppCmd(JSON.stringify(myObj));
			myObj = { "cmd": "rawQuery", "value": {"sql":"select * from test"}};
			callAppCmd(JSON.stringify(myObj));
			myObj = { "cmd": "rawQuery", "value": {"sql":"select count(*) from test"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function setNotiViewed(){
			var myObj = { "cmd": "setNotiViewed", "value":{"id": "4f6e493e-a4d6-46ad-ab06-7925dd4255b0"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function openUrl(){
			var myObj = { "cmd": "openCamera", "value":{"type": "openUrl"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function getBarCode(){
			var myObj = { "cmd": "openCamera", "value":{"id": "barcode", "type": "barcode"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function getQRCode(){
			var myObj = { "cmd": "openCamera", "value":{"id": "QRCode", "type": "QRCode"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function getQRCodeCustom(){
			var myObj = { "cmd": "openCamera", "value":{"id": "QRCode", "type": "QRCode", "mode": "custom"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function closeCamera(){
			var myObj = { "cmd": "closeCamera"};
			callAppCmd(JSON.stringify(myObj));
		}
		function getCamera(){
			var myObj = { "cmd": "openCamera", "value":{"id": "takePhoto", "type": "takePhoto"}};
			callAppCmd(JSON.stringify(myObj));
		}
		function pickFileAlbum(){
			var myObj = { "cmd": "pickFile", "value":{"type":"album", "count":10}};
			callAppCmd(JSON.stringify(myObj));
		}
		function pickFileDoc(){
			var myObj = { "cmd": "pickFile", "value":{"type":"document", "count":5}};
			callAppCmd(JSON.stringify(myObj));
		}
		function pickFileAll(){
			var myObj = { "cmd": "pickFile", "value":{"type":"all", "count":5}};
			callAppCmd(JSON.stringify(myObj));
		}
		function speech(){
			var myObj = { "cmd": "speechRecognize"};
			callAppCmd(JSON.stringify(myObj));
		}
		function cancelSpeech(){
            var myObj = { "cmd": "cancelSpeechRecognize"};
            callAppCmd(JSON.stringify(myObj));
        }
		function getRestNew_(){
			var myObj = { "cmd": "rest", "value":{"id": "rest1", "restConfig": {"name":"echo.base","body":myObj1,"relativePath":'/api/v1/echo',"method":"POST"}}};
			callAppCmd(JSON.stringify(myObj));
		}
		function getRestNew(){
			//var myObj = { "cmd": "rest", "value":{"id": "rest1", "restConfig": {"name":"Duty","relativePath":'/EmpID/831765/GetHomeInfoByEmp',"method":"GET", "body":{"test":"aaa","a":"bb"}}}};
			//var myObj = { "cmd": "rest", "value":{"id": "rest1", "restConfig": {"name":"apis.spa.qa.ex","method":"GET"}}};
			var myObj = { "cmd": "rest", "value":{"id": "rest1", "restConfig": {"name":"photo","relativePath":'/831765',"method":"GET"}}};
			var str = callAppCmd(JSON.stringify(myObj));

		}
		function callAppCmd (params) {			
			if (window.webkit != undefined) {
				// for iOS
				window.webkit.messageHandlers.callAppCmd.postMessage (params);
				return undefined;
			  } else {
				// for Android
				window.android.callAppCmd(params);
			  }
		 }
		function appCmdCallback(str){
			alert("appCmdCallback: " + str);
			var obj = JSON.parse(str);
			if (obj.cmd!='pickFile') {
				alert(obj.value.data);
				document.getElementById('img').src=obj.value.data;
			} else {
			//alert(obj.value.apis[0].url);
			//alert(obj(obj.value.data));
			//document.getElementById('img').src="data:image/jpeg;base64," + btoa(obj.value.data);
			//document.getElementById('img').src=obj.value.data;
				for(var i=1;i<=obj.value.length;i++) {
					//alert(obj.value[i-1].name);
					document.getElementById('img'+i).src=obj.value[i-1].data;
				}
			}
			//alert("aaa");
			//alert(obj.value.photo);
			//document.getElementById('img').src=obj.value.photo;
		}
		function getGPS(){
			var myObj = { "cmd": "retrieveGeolocation", "value": null};
			var str = callAppCmd(JSON.stringify(myObj));
			//alert(str);
		}
		function getTelInfo(){
			var myObj = { "cmd": "getTelInfo", "value": null};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function goPortal(){
			var myObj = { "cmd": "goPortal", "value": null};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function getAuthNew(){
			var myObj = { "cmd": "postAuth", "value": null};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function dialPhoneNumber(){
			var myObj = { "cmd": "dial", "value": {"number":"0988170521"}};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function dialPhoneNumber2(){
			var myObj = { "cmd": "dial", "value": {"number":"02-23442949"}};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function composeEmail(){
			var myObj = { "cmd": "mail", "value": {"mail":"sylvie@cht.com.tw"}};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function teams(){
			var myObj = { "cmd": "teams", "value": {"mail":"sylvie@cht.com.tw"}};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function goApp(){
			var myObj = { "cmd": "goApp", "value": "com.cht.eip"};//hrm-whs
			var str = callAppCmd(JSON.stringify(myObj));
		}
		function goAppArg(){
            var myObj = { "cmd": "goApp", "value":{ "appId":"com.cht.test","data":{"messageId":"3cfabc1f-683e-4d95-a62b-95f8192a4452_1"}}};//hrm-whs
            var str = callAppCmd(JSON.stringify(myObj));
        }
		function getAppConfig(){
			var str = window.JavaScriptInterface.callAppCmd('appConfig','com.cht.hrm-whs', 'getRestRes', null);
			//alert(str);
		}
		function reAuth(){
			var str = window.JavaScriptInterface.callAppCmd('postAuth','com.tripim.ictinv', 'getRestRes', null);
			//alert(str);
		}
		function getUserInfo(){
			var str = window.JavaScriptInterface.callAppCmd('userInfo','myPayloadUser', 'getRestRes', null);
			//alert(str);
		}
		function getAppList(){
			//null
			var str = window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList', 'getRestRes', null);
			//alert(str);
			//0 ele
// <!--			window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList2',[]);-->
// <!--			//null-->
// <!--			window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList3','');-->
// <!--			//first 2 ele null-->
// <!--			window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList4',[1,2,3,4]);-->
// <!--			//1, and 2 more ele null-->
// <!--			window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList5',['1',2,3,4]);-->
// <!--			//1, null, 3, null, 5-->
// <!--			window.JavaScriptInterface.callAppCmd('appList','myPayloadAppList6',['1',2,'3',4,'5']);-->
		}
		function getWebView(){
			location.href = 'https://spa-template.azurewebsites.net/#/CHTAppCmdDemo';
			//window.JavaScriptInterface.callAppCmd('webView','https://www.google.com.tw',null);
			//window.JavaScriptInterface.callAppCmd('webView','http://spa-template.azurewebsites.net/#/CHTAppCmdDemo', null, null);
		}
		function getRest(){
			var myObj = {'a':'234', 'b':'456'};
			//window.JavaScriptInterface.callAppCmd('rest','com.cht.mportal', 'getRestRes', ['echo.base', 'GET', null, null, JSON.stringify(myObj), '/api/v1/echo']);

			//alert(JSON.stringify(myObj));
			window.JavaScriptInterface.callAppCmd('rest','com.cht.mportal', 'getRestRes', ['apis.spa.qa.ex', 'GET', null, null, null, null]);

			//var myObj = {'content-type':'application/json'};
			//var myObj2 = {"cmd": "getStaffInfo", "staff": "829782"};
			//window.JavaScriptInterface.callAppCmd('rest','com.cht.force', ['force.qa.ex', 'getRestRes', 'POST', JSON.stringify(myObj), JSON.stringify(myObj2), null, '/forceapp/api/force/getworksheet']);
		}
		function getAuth(){
			window.JavaScriptInterface.callAppCmd('postAuth', 'com.cht.mportal', 'getRestRes', null);
		}
		function getDefault(){
			window.JavaScriptInterface.callAppCmd('anything','myPayloadDefault', 'getRestRes', ['1','2','3','asdfgh']);
		}
		function getFail(){
			window.JavaScriptInterface.callAppCmd('appList','');
		}
		function getResult(str){
			alert("getResult: " + str);
			//var obj = JSON.parse(str);
			//alert(obj['cmd'] + ' ~ ' + obj['res']);
		}
		function getRestRes(str){
			alert("getRestRes:" + str);
			//var obj = JSON.parse(str);
			//alert('getRestRes: ' + obj['cmd'] + ' ~ ' + obj['resCode'] + ' ~ ' + obj['name'] + ' ~ ' + obj['result']);
		}
	</script>
</html>