<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>巴黎奧運網路監視</title>
  	<link rel="dns-prefetch" href="//fonts.googleapis.com">
  	<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900&display=swap">
  	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>	  
	<link rel="stylesheet" href="js/filker/jquery-ui.min.css">
	<script src="bootstrapV4/js/bootstrap.min.js"></script>	
	<link href="bootstrapV4/css/bootstrap.min.css" rel="stylesheet">  
	<link rel="stylesheet" href="css/bootstrap-icons/bootstrap-icons.css">	
	<script src="xss-filters.min.js"></script>
	<link href="argusApp.css" rel="stylesheet">  
	<script src="js/argus.app.js"></script>
	<link rel="stylesheet" type="text/css" href="js/jqGrid/css/ui.jqgrid.css" />
	<script src="js/jqGrid/js/i18n/grid.locale-en.js" type="text/javascript"></script>
	<script src="js/jqGrid/js/jquery.jqGrid.min.js" type="text/javascript"></script>
	<link rel="stylesheet" type="text/css" href="js/jqGrid/changeLine.css" />		
  <style type="text/css">
		
  </style>
</head>
<body>
	<div class="I-Body">
		<div class="row">
			<div class="col-sm-12">	
				<div onclick="goPre()" style="font-size: 24px;"><i class="bi bi-chevron-left"></i> <b >巴黎奧運網路監視</b></div>
					<div id="qrytime" class="item-right"><b>呈現時間:</b>&nbsp;<span id="refreshTime">讀取中...</span></div>
				<br>		
				<div class="card">	
					<div class="card-header bgBlue">
						<b><span id ="eName"></span>電路清單</b>
					</div>		
					<div class="card-body" style="padding: 2px;">
						<div id="mainContent" style="padding: 2px;font-size: 14px;height: 540px; overflow-y: auto;overflow-x: hidden;" > 
							<table id="jqEventTable" > </table>
						</div >		
					</div>	
				</div>	
			</div>	
		</div>

		<div class="row  customLabel">
			<div class="col-3" >
				<table width=100%>
					<tr align="center" style="vertical-align: middle; height:60px " class="kindTitle">
					<td>
						<h3 style="padding-top: 8px;"><a href="#" class="badge badge-secondary" style="background: #4070B1;" onclick="goPage('1')">網路<br>拓樸</a></h3>
					</td>
					</tr>
				</table>
			</div>
			<div class="col-3" >
				<table width=100%>
					<tr align="center" style="vertical-align: middle; height:60px " class="kindTitle">
					<td>
						<h3 style="padding-top: 8px;"><a href="#" class="badge badge-secondary" style="background: #4070B1;" onclick="goPage('2')">服務<br>狀態
						</a></h3>
					</td>
					</tr>
				</table>
			</div>
			<div class="col-3" >
				<table width=100%>
					<tr align="center" style="vertical-align: middle; height:60px " class="kindTitle">
							<td>
							<h3 style="padding-top: 8px;"><a href="#" class="badge badge-secondary" style="background: #4070B1;" onclick="goPage('3')">收視<br>指標</a></h3>
							</td>
					</tr>
				</table>
			</div>
			<div class="col-3" >
				<table width=100%>
					<tr align="center" style="vertical-align: middle; height:60px " class="kindTitle">
							<td>
							<h3 style="padding-top: 8px;"><a href="#" class="badge badge-secondary" style="background: #4070B1;" onclick="goPage('4')">ISP<br>互連<br></a></h3>
							</td>
					</tr>
				</table>
			</div>
		</div>
	</div>
</body>
</html>

<script>
	var _jsonSource = "[{\"no\":\"1\",\"sysname\":\"223D73382\",\"remark\":\"PTN；國際段：2UB14452，愛國機房-仁愛訊號中心；速率：750M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12230\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"2\",\"sysname\":\"223D73383\",\"remark\":\"PTN；國際段：2UB14453，愛國機房-仁愛訊號中心；速率：750M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12230\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"3\",\"sysname\":\"223E93974\",\"remark\":\"台中公館MOD頭端-CND(Hami Video)；速率：100M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12240\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"4\",\"sysname\":\"223Y916827\",\"remark\":\"仁愛訊號中心；速率：1G／600M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447並記錄於工作日誌\",\"site\":\"12127\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"5\",\"sysname\":\"223Y916828\",\"remark\":\"仁愛訊號中心；速率：1G／600M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447並記錄於工作日誌\",\"site\":\"12127\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"6\",\"sysname\":\"223YV901472\",\"remark\":\"Hami Video VOD 50M\",\"contact\":\"熱線數分DNOC值班人員並記錄於工作日誌\",\"site\":\"12129\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"7\",\"sysname\":\"223YV901473\",\"remark\":\"Hami Video VOD 50M\",\"contact\":\"熱線數分DNOC值班人員並記錄於工作日誌\",\"site\":\"12129\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"8\",\"sysname\":\"288E91012\",\"remark\":\"陽明山-台中公館MOD頭端；速率：300M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12241\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"9\",\"sysname\":\"2UB14452\",\"remark\":\"愛國-日本東京；主路由APCN2、備用路由NCP；速率：750M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；熱線INOC並記錄於工作日誌\",\"site\":\"12230\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"10\",\"sysname\":\"2UB14453\",\"remark\":\"新加坡-愛國；主路由EAC、備用路由CSCN台港SJC港新；速率：750M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；熱線INOC並記錄於工作日誌\",\"site\":\"12230\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"11\",\"sysname\":\"TCKK-TCKK-10GE-46\",\"remark\":\"台中公館MOD頭端-MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；南區網管中心：04-23445865並記錄於工作日誌\",\"site\":\"12239\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"12\",\"sysname\":\"TCKK-TCKK-10GE-47\",\"remark\":\"台中公館MOD頭端-MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；南區網管中心：04-23445865並記錄於工作日誌\",\"site\":\"12239\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"13\",\"sysname\":\"TCKK-TCKK-10GE-48\",\"remark\":\"台中公館MOD頭端-MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；南區網管中心：04-23445865並記錄於工作日誌\",\"site\":\"12239\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"14\",\"sysname\":\"TCKK-TCKK-10GE-49\",\"remark\":\"台中公館MOD頭端-MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；南區網管中心：04-23445865並記錄於工作日誌\",\"site\":\"12239\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"15\",\"sysname\":\"TPA3-TPS2U3-OCH-803\",\"remark\":\"衛星主陽明山-仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12133\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"16\",\"sysname\":\"TPA3-TPS2U3-OCH-804\",\"remark\":\"衛星主陽明山-仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12133\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"17\",\"sysname\":\"TPDB-TPS2U3-10GE-1\",\"remark\":\"仁愛訊號中心-- Hami Video；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；熱線數分DNOC值班人員並記錄於工作日誌\",\"site\":\"12129\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"18\",\"sysname\":\"TPDB-TPS2U3-10GE-2\",\"remark\":\"仁愛訊號中心-- Hami Video；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；熱線數分DNOC值班人員並記錄於工作日誌\",\"site\":\"12129\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"19\",\"sysname\":\"TPS1DG-TPS2U3-OCH-801\",\"remark\":\"仁愛訊號中心-漢口攝影棚；速率：270M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12132\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"20\",\"sysname\":\"TPS1DG-TPS2U3-OCH-802\",\"remark\":\"仁愛訊號中心-漢口攝影棚；速率：270M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12132\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"21\",\"sysname\":\"TPS2-TPS2U3-10GE-3\",\"remark\":\"仁愛訊號中心--IP骨幹中心MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12130\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"22\",\"sysname\":\"TPS2-TPS2U3-10GE-4\",\"remark\":\"仁愛訊號中心--IP骨幹中心MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12130\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"23\",\"sysname\":\"TPS2-TPS2U3-10GE-5\",\"remark\":\"仁愛訊號中心--IP骨幹中心MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12130\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"24\",\"sysname\":\"TPS2-TPS2U3-10GE-6\",\"remark\":\"仁愛訊號中心--IP骨幹中心MR；速率：10G\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12130\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"25\",\"sysname\":\"TPS24V-TPS2U3-OCH-801\",\"remark\":\"衛星備服務大樓-仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12136\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"26\",\"sysname\":\"TPS24V-TPS2U3-OCH-802\",\"remark\":\"衛星備服務大樓--仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12136\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"27\",\"sysname\":\"TPS24V-TPS2U3-OCH-803\",\"remark\":\"衛星備服務大樓--仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12136\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"28\",\"sysname\":\"TPS24V-TPS2U3-OCH-804\",\"remark\":\"衛星備服務大樓--仁愛訊號中心；速率：270M\",\"contact\":\"申告平台處值班窗口：02-23412445、02-23412447並記錄於工作日誌\",\"site\":\"12136\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"29\",\"sysname\":\"TPS2U3-S31P-OCH-903\",\"remark\":\"仁愛訊號中心-重南攝影棚；速率：270M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12131\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"},{\"no\":\"30\",\"sysname\":\"TPS2U3-S31P-OCH-904\",\"remark\":\"仁愛訊號中心-重南攝影棚；速率：270M\",\"contact\":\"申告平台處值班窗口：02-2341244502-23412447；北區網管中心：23445006並記錄於工作日誌\",\"site\":\"12131\",\"note\":\"\",\"suppress\":\"N\",\"des\":\"\",\"status\":\"1\"}]" ;
	
	var refreshSecond = 30;						// 30 秒
	var refreshTime = refreshSecond;			
	var isReLoad = false;
	
	var _empID="";
	var _haveAuth = "false";
	var _projectId = "376";				// 奧運收視數專案編號
	var _name ="";

	
	// 奧運電路專案ID 376
	// https://argus.cht.com.tw/argus_project_api/V1/argusProject/?projectId=376&category=sysStatus

	//==============================
	// 初始呼叫
	//==============================
	$(document).ready(function() {
	
		var events = JSON.parse(_jsonSource); 
		$('#jqEventTable').show();
		showAtTable(events);
		
		refreshTime = 1;	// 設1預設才會run
		changeRefreshTime();
		pageRefresh();
	}); 


	

	function changeRefreshTime(){
		refreshTime = refreshSecond;
		$('#refreshTime').html(getNowTime());
	}	

	//==============================
	// 更新時間
	//==============================
	function pageRefresh(){
		refreshTime -= 1;	
		if (refreshTime==0){
			refreshContent();			
		}else{			
		}
		cleartime = setTimeout("pageRefresh()",1000);
	}

	//==============================
	// 更新內容
	//==============================
	function refreshContent(){
		changeRefreshTime();
		
		if(_haveAuth=="true"){
			getRest("sysStatus");
		}
		
	}
	
		//=======================================
		//SPA API 教學
		//=======================================		
		//https://dev.azure.com/cht-tl-poc/_git/SPA-Template?path=%2Fdocs%2Fos-level-comm-spec.md&_a=preview
	
		
		//=======================================
		//callAppCmd 呼叫API
		//=======================================	
		function callAppCmd (params) {			
			if (window.webkit != undefined) {
				// for iOS
				window.webkit.messageHandlers.callAppCmd.postMessage (params);
				return undefined;
			  } else {
				// for Android
				window.android.callAppCmd(params);
			  }
		 }
		 
		//=======================================
		//appCmdCallback 呼叫API
		//=======================================	
		 function appCmdCallback(str){
		//	alert("appCmdCallback: " + str);
			var obj = JSON.parse(str);
			
			var _theValue = obj.value;
			
			if(obj.cmd=='getInitInfo'){
				_empID =_theValue.userInfo.empID;
				checkAuth();
			}else if(obj.cmd=='rest'){
				var _result = _theValue.data;
				//=====================
				// 權限判斷
				//=====================
				if(_theValue.id=='restCheckAuth'){				
					_haveAuth =  _result.items[0].value;
					if(_haveAuth=="true"){
						refreshContent();
					}else{
						$('#messageModel').modal('show');		
					}
				//	alert("_haveAuth"  + _haveAuth +"   " + _result);
				}else{
					// 事件呈現
					var events= _result.items[0].value;
					if(events.length >0){			
						$('#jqEventTable').show();
						showAtTable(events);	
					}else{
						//$('#jqEventTable').hide();
					}				
					
				}
			}else{
				
			}		
		}
		
		
		

		//=======================================
		//回上一頁
		//=======================================
		function goPre(){
			//var myObj = { "cmd": "goPortal", "value": null};
			//var str = callAppCmd(JSON.stringify(myObj));
			history.go(-1);
		}
	
	
		//=======================================
		//argus api-檢查權限
		//=======================================
		function checkAuth(){
			var _authCheckStr = "auth_"+_empID;
			//https://argus.qa.cht.com.tw/argus_project_api/V1/argusProject/?projectId=0&category=auth_
			var myObj = { "cmd": "rest","value":{"id": "restCheckAuth","restConfig":{"name":"getMetric","queryParams":{"projectId":"0","category":_authCheckStr},"relativePath":"argusProject/getMetric.jsp","method":"get"}}};
			var str = callAppCmd(JSON.stringify(myObj));
		}
		
		//=======================================
		//argus api PM 參數
		//=======================================
		function getRest(_category){
			var _id = "rest"+_category;
			var myObj = { "cmd": "rest","value":{"id": _id,"restConfig":{"name":"getMetric","queryParams":{"projectId":_projectId,"category":_category},
			"relativePath":"argusProject/getMetric.jsp","method":"get"}}};
			
			var str = callAppCmd(JSON.stringify(myObj));
			//alert(str);
		}
				
		function goPage(pIdx){
			if(pIdx=="1"){
				location.href = 'indexO2024.html';
			}else if(pIdx=="2"){
				location.href = 'indexService.html';
			}else if(pIdx=="3"){
				location.href = 'indexRating.html';
			}else if(pIdx=="4"){
				location.href = 'indexISP.html';
			}
		}
		
		
		
		//=======================================
		// 取得參數
		//=======================================
		function findGetParameter(parameterName) {
			var result = null,
				tmp = [];
			location.search
				.substr(1)
				.split("&")
				.forEach(function (item) {
				  tmp = item.split("=");
				  if (tmp[0] === parameterName) result = decodeURIComponent(tmp[1]);
				});
			return result;
		}
		
		
		
		
		function customStatus(cellvalue, options, rowObject){					 
			var _des ="處理中";
			if(rowObject.closedTime==""){
				if(cellvalue=="影響服務")
					_des ="處理中(影響服務)";
			}else{
				_des = "已結束";
			}
			return _des ;
		}
	
		function customDes(cellvalue, options, rowObject){					 
			var _des =rowObject.description;
			
			return _des ;
		}
	
	
		function customerState(cellvalue, options, rowObject){	
			var theV = "01";
			
			if(cellvalue=="1"){
				 theV = "01";
			}else if(cellvalue=="2"){
				 theV = "02";
			}else if(cellvalue=="3"){
				 theV = "03";
			}else if(cellvalue=="5"){
				 theV = "05";
			}else if(cellvalue=="52"){
				 theV = "05";
			}else if(cellvalue=="none"){
				 theV = "00";
			}
			
			var _imgStr ="<img class=\"statusIcon\" src='img/light2/"+theV +".png' >";
			 if(cellvalue=="52"){
				 _imgStr += "<br><span style=\"font-size:small\">處理中</span>";
			}
			
			return _imgStr;
		}
	
		function customSYS(cellvalue, options, rowObject){	
				return "<b>"+rowObject.sysname+
									"</b><br>"+rowObject.remark +
									"&nbsp;&nbsp;</div>" ;			
		}
	
		//=======================================
		// 呈現事件
		//=======================================		
		function showAtTable(rData){			  
			
				theColNames = ["","狀態","電路"];
				theColModel = [		
						{name:'no',index:'no',width : 10,sorttype:'number' , align:'center'},	
						{name:'status',index:'status',width : 15,sorttype:'string', align:'center',formatter:customerState },			
						{name:'sysname',index:'sysname',width : 100,sorttype:'string' , align:'left',formatter:customSYS}
					];	
				
				var myRowFormatter = function(elTr, oRecord) {    
				    return true;
				}; 
			 
	        	//$("#dmLoading").hide();	
				if(isReLoad){
						//alert(isReLoad+" reload");
	    				drawjqTableReload($("#jqEventTable"),pageDiv,rData);					
	    		}else{
		    		$("#jqEventTable").jqGrid({
						data: rData, 
						datatype: "local",
						height: "auto",	
						autowidth: true, // 自動欄寬           
						colNames: theColNames,
						colModel:theColModel,
						rowNum:50,
						rowList:[50,80,100],
						//pager: pageDiv,
						caption: ""					
					});		
					isReLoad = true;
	    		}	
		  }  	

	</script>
	
 <div class="modal hide fade" data-keyboard="false" data-backdrop="static" id="messageModel" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">    	     
        <div class="modal-body">
			很抱歉您沒有權限，請於電子表單申請帳號-IS32進行權限申請， 系統請選Argus->申請ARGUS帳號
        </div> 
		<div class="modal-footer">
           <button type="button" class="btn btn-success" onclick="goPortal()">確定</button>
        </div>		
      </div>
    </div>
  </div>